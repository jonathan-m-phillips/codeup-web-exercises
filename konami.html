<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>Konami Code</title>
</head>

<!--   custom css file   -->
<link rel="stylesheet" href="css/konami.css">


<body>

<audio src="audio/npc-yc_mario-win.wav"></audio>

<h1 id="konami-header">Enter the konami code!</h1>

<!--   wrapping the buttons into a container   -->
<div class="body-container">

    <!--    wrapping the arrow buttons into a container   -->
    <div class="arrows-container">
        <img src="img/up@330x.png" id="top-arrow">
        <img src="img/right@330x.png" id="right-arrow">
        <img src="img/middle@330x.png" id="middle-arrow">
        <img src="img/down@330x.png" id="bottom-arrow">
        <img src="img/left@330x.png" id="left-arrow">
    </div>

    <!--    wrapping the letter buttons into a container   -->
    <div class="buttons-container">
        <img src="img/a@330x.png" id="a-button">
        <img src="img/b@330x.png" id="b-button">
    </div>

    <!--   restart button   -->
    <p class="restart" onclick="reloadPage();">Restart</p>


</div>

<!--   linking to jquery locally   -->
<script src="js/jquery-3.5.1.js"></script>

<script>

    // creating arrays for allowed user input in konami code
    let allowedKeys = {
        37: 'left',
        38: 'up',
        39: 'right',
        40: 'down',
        65: 'a',
        66: 'b',
        13: 'enter'
    };


    // creating a buttons clicked object
    // let buttonsClicked = {};
    //
    // $(document).ready(function () {
    //     $('#top-arrow').click (function () {
    //         buttonsClicked.push(allowedKeys[1]);
    //         console.log(buttonsClicked);
    //     });
    // });
    //
    // console.log(buttonsClicked);

    // konami code array
    let konamiCode = ["up", "up", "down", "down", "left", "right", "left", "right", "b", "a", "enter"];

    // user input position on the code
    let currentPosition = 0;


    // alert if user input correct code
    let correctCode = "You are granted 30 extra lives!";


    // keydown event function
    $(document).keydown(function (e) {

        // if a button is entered, a button image will appear and the rest will disappear
        if (e.code === 'ArrowUp') {
            $('#top-arrow').show();
            $('#left-arrow').hide();
            $('#right-arrow').hide();
            $('#bottom-arrow').hide();
            $('#b-button').hide();
            $('#a-button').hide();
            $('#middle-arrow').hide();
        } else if (e.code === 'ArrowDown') {
            $('#top-arrow').hide();
            $('#left-arrow').hide();
            $('#right-arrow').hide();
            $('#bottom-arrow').show();
            $('#b-button').hide();
            $('#a-button').hide();
            $('#middle-arrow').hide();
        } else if (e.code === 'ArrowLeft') {
            $('#top-arrow').hide();
            $('#left-arrow').show();
            $('#right-arrow').hide();
            $('#bottom-arrow').hide();
            $('#b-button').hide();
            $('#a-button').hide();
            $('#middle-arrow').hide();
        } else if (e.code === 'ArrowRight') {
            $('#top-arrow').hide();
            $('#left-arrow').hide();
            $('#right-arrow').show();
            $('#bottom-arrow').hide();
            $('#b-button').hide();
            $('#a-button').hide();
            $('#middle-arrow').hide();
        } else if (e.code === 'KeyB') {
            $('#top-arrow').hide();
            $('#left-arrow').hide();
            $('#right-arrow').hide();
            $('#bottom-arrow').hide();
            $('#b-button').show();
            $('#a-button').hide();
            $('#middle-arrow').hide();
        } else if (e.code === 'KeyA') {
            $('#top-arrow').hide();
            $('#left-arrow').hide();
            $('#right-arrow').hide();
            $('#bottom-arrow').hide();
            $('#b-button').hide();
            $('#a-button').show();
            $('#middle-arrow').hide();
        } else if (e.code === 'Enter') {
            $('#top-arrow').show();
            $('#left-arrow').show();
            $('#right-arrow').show();
            $('#bottom-arrow').show();
            $('#b-button').show();
            $('#a-button').show();
            $('#middle-arrow').show();
        } else {
            alert('That is not a real control! Click restart to start over.');
        }

        // adding user input to key
        let key = allowedKeys[e.keyCode];
        // let keys = allowedKeys[buttonsClicked];

        // debugging keys
        // console.log(key)

        // requiredKey set equal to current position in the konami code array
        let requiredKey = konamiCode[currentPosition];

        // incrementing current position in konami code if the required key is entered
        if (key == requiredKey) {// || keys == requiredKey) {
            currentPosition++

            // if current position of konami code is the same length as the konami code call function cheatMode and reset current position to 0 to restart the code
            if (currentPosition == konamiCode.length) {
                cheatMode();
                currentPosition = 0;
            }
        }

        // if current position does not equal full length of konami then reset to the beginning
        else {
            currentPosition = 0;
        }

    });

    // cheatMode set to alert correctCode if all keys entered correctly
    function cheatMode() {
        $('body').css({
            'backgroundColor': 'red',
            'color': 'white'
        });


        $('h1').html("You did it! You activated the code!")
        alert("You just earned 30 lives!!!");
        let audio = $("audio")[0];
        audio.play();


        $('.restart').on("click", function () {
            $('body').css({
                'backgroundColor': 'white',
                'color': 'black'
            })
        });

    }

    function reloadThePage() {
        $('.restart').click(function () {
            window.location.reload(true);
        });
    }

    reloadThePage();



</script>
</body>
</html>